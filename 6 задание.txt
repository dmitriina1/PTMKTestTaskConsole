До оптимизации пункт 5 выполнялся за 770 мс, тогда дата генерировалась автоматически со временем.
Для оптимизации тип DateTime был заменен на DateOnly, а также время в базе данных было установлено в 00:00:00, 
что позволило ускорить работу до 660 мс.